```
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣤⣴⣶⡆⠀⣶⣶⣦⣤⣤⣄⠀ ⢠⣾⣿⣦
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⢰⣿⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⡄⠘⢿⣿⠟
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣾⣿⣧⠀⢻⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⣿⠂⢠⣠⣤⣶⣦⡀
                                    ⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣇⠈⢿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⠏⢀⣿⣿⣿⣿⣿⣿⣦⡀
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣿⣿⡆⠘⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⡏⠀⣾⣿⣿⣿⣿⣿⣿⡿⠋⢀
                                    ⠀⠀⠀⣴⣿⣦⡀⠙⢿⣿⣿⣿⣿⣿⣿⡄⠸⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⡟⠀⣼⣿⣿⣿⣿⣿⣿⠟⢀⣴⣿⣧
                                    ⠀⠀⣼⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣿⣷⡀⢹⣿⣿⣿⡇⠀⣿⣿⣿⡿⠁⣰⣿⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣧
                                    ⠀⣼⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣧⠀⢻⣿⣿⡇⠀⣿⣿⣿⠃⢰⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⠀⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣇⠀⢿⣿⡇⠀⣿⣿⠇⢠⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠃
                                    ⣼⣶⣤⣄⡈⠙⠛⠿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⡆⠈⠛⠃⠀⠛⠋⠀⣾⣿⠟⠁⣠⣾⣿⣿⣿⣿⡿⠿⠛⠉⣀⣠⣴⣶⡄
                                    ⣿⣿⣿⣿⣿⣿⣶⣤⣀⡉⠙⠻⢿⣿⣿⣦⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⠁⢠⣾⣿⣿⠿⠛⠋⢁⣠⣴⣶⣿⣿⣿⣿⣿⣿⡀
                                    ⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣤⣀⠉⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠋⢁⣀⣤⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁⠀⣠⣶⣄
                                    ⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀ ⢻⣿⣿⡿
                                    ⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠂⠀⠈⠙⠋
                                    ⠀⠀⠘⣿⣿⣿⣿⣿⠿⠛⠋⢁⣠⣤⣶⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋
                                    ⠀⠀⠀⠘⠟⠋⢉⣀⣤⣶⣿⣿⣿⣿⠟⠁⣠⣦⣄⡀⠀⠀⠀⠀⠀⠀⣤⣦⡈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠁
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⠟⠁⣠⣾⣿⣿⣿⣿⣿⣶⣶⣾⣧⠀⢻⣿⣿⣦⡈⠻⣿⣿⣿⣿⡿⠟⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠙⠿⣿⡟⠁⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠈⠿⢿⣿⣿⣦⡈⠻⠛⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠺⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⢀⣤⣤⡈⠙⠋⠁
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠻⠿⠿⠿⠿⠿⠿⠇⠀ ⣿⣿⣿⡇
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀   ⠈⠙⠋

                         /██   /██   /██   /██   /██████    /██████     /██████    /██      /██   /███████
                        | ██  | ██  | ███ | ██  |_  ██_/   /██__  ██   /██__  ██  | ███    /███  | ██__  ██
                        | ██  | ██  | ████| ██    | ██    | ██  \__/  | ██  \ ██  | ████  /████  | ██  \ ██
                        | ██  | ██  | ██ ██ ██    | ██    | ██        | ████████  | ██ ██/██ ██  | ███████/
                        | ██  | ██  | ██  ████    | ██    | ██        | ██__  ██  | ██  ███| ██  | ██____/
                        | ██  | ██  | ██\  ███    | ██    | ██    ██  | ██  | ██  | ██\  █ | ██  | ██
                        |  ██████/  | ██ \  ██   /██████  |  ██████/  | ██  | ██  | ██ \/  | ██  | ██
                         \______/   |__/  \__/  |______/   \______/   |__/  |__/  |__/     |__/  |__/
```
<p align="right"><b><sub>Version: 1.0.1</sub></b></p>

<p align="center"><b>Authors</b></p>
<p align="center">
Flavia N. Braga<br>
Luís Fernando M. Franco<br>
 
# Abstract 
<p align="justify">
  The codes presented in this page were used to develop the dissertation of Flávia Nogueira Braga in partial fulfillment of the requirements for the degree of Master in Chemical Engineering at Unicamp - Brazil. The dissertation entitled "Study of diffusion aspects in confined media subject to external electric potential for application in catalysis via Molecular Dynamics simulations" is attached. 
  In this dissertation, Molecular Dynamics was employed to conduct an exploratory study of the behavior of confined fluids subjected to an external electric field using GROMACS software. The simulations were performed at CENAPAD (Centro Nacional de Processamento de Alto Desempenho em São Paulo). The system of interest for this study was the Fischer-Tropsch synthesis, as a part of the gas to liquid process to transform natural gas into larger hydrocarbons. A mixture of water with hydrocarbons, modeled by methane, n-butane, and n-pentane, confined in a graphene slit pore is chosen to assess the influence of the external electric field in the general confinement behavior.
 
 
## Contents
* <a href="#disclaimer">1. Disclaimer</a>
* <a href="#language">2. Language</a>
* <a href="#building-and-compilation">3. Building and Compilation</a>
* <a href="#reporting-errors">4. Reporting Errors</a>
* <a href="#initial-configuration">5. Inicial configuration</a>
* <a href="#input-files-preparation">6. Input files preparation</a>

## Disclaimer
<p align="justify">
The authors make no warranties about the use of this codes. The authors hold no liabilities for the use of this software. The authors do not recommend the use of this software whatsoever. The algorithm is made freely available to clarify any details discussed in the dissertation. All information contained herein regarding any specific methodology does not constitute or imply its endorsement or recommendation by the authors.
</p>

## Language
<p align="justify">
The main program, subroutines and functions contain some explanatory comments are mainly written in C language. 
</p>

## Building and Compilation
<p align="justify">

  For compilation, we have used the GNU Compiler Collection (GCC). We tested the algorithm using some GCC versions: 9.3.0 in Ubuntu 20.04 LTS and 7.5.0 in Ubuntu 18.04 LTS.
</p>

## Reporting Errors
<p align="justify">
If you spot an error in the program files and all other documentation, please submit an issue report using the <a href="https://github.com/Flavianbraga/Codes-for-dissertation/issues)">Issues</a> tab.
</p>

## Inicial configuration
<p align="justify">
Before running the simulations with GROMACS (version 2021.2 tested) the initial files have to be prepared for the simulation using the softwares PACKMOL, GROMACS in addition to C codes.
  The system chosen as representative of the Fischer-Tropsch synthesis was the product of the reaction: hydrocarbons and water, confined in a slit pore of graphene sheets, with 5 layers in each side of the pore of 5.88 nm of width [Papavasileiou et al., 2021]. The hydrocarbons selected were methane, n-butane, and n-pentane. The composition of the mixtures studied were calculated based on the stoichiometry of the FTS reaction and assumes a 1:1 H 2 O : CH x (x = 2 or 3) ratio in the pore.
  
### Graphene sheets
  
Initially,the graphene sheets were built, using the files in <a href="https://github.com/Flavianbraga/Codes-for-dissertation/tree/main/graphene">Graphene</a>. First one sheet of graphene was created based on a sort of unitary cell of 4 atoms of carbon, forming half of regular hexagon with an angle of 120° between the atoms, as show in  file GRA1.gro and represented in Figure 01. 

  <em><p align="center">
  <b>Figure 01</b>. Hexagonal carbons to form graphenne.
</p></em>

![vmd_hexagon](https://user-images.githubusercontent.com/98060271/203320930-e663ae3c-cfb7-4a35-99ef-25449f14e405.png)

Next, the coordinates of the atoms were replicated in axes x, y, and z respectively 19, 11 and 1 times, resulting in one layer of 836 atoms of carbon. The result can be seen in Figure 2. This was done using the gmx genconf tool of GROMACS:

  ```console
gmx genconf -f GRA1.gro -o GRA_sheet1.pdb -nbox 19 11 1
 ```
  
  <em><p align="center">
  <b>Figure 02</b>. One sheet of graphene.
</p></em>
  
  ![vmd_1sheet](https://user-images.githubusercontent.com/98060271/203323492-cce97136-2549-4205-8051-4d69edb376d0.png)
  
  To build the total structure of the slit pore PACKMOL was used, consisting of two blocks of five Bernal-stacked multilayer graphene [Rao et al., 2009]. The distance used between the layers in the same block was 3.48 Å. Moreover, in this kind of block, the multilayers are not perfectly aligned, instead they present a displacement of 0.14 nm between them, as represented in Figure 3.3. To build one block, the file gra5.inp is used as follow: 

  ```console
 packmol < gra5.inp
 ```
      
<em><p align="center">
  <b>Figure 03</b>. One block of graphene sheets.
</p></em>
                    
 ![vmd_10sheets](https://user-images.githubusercontent.com/98060271/203325408-28a3788f-9d8a-4f2e-a0ba-34451c8fab1b.png)

It is important to remember that when using GROMACS, the initial files must be in the format .gro. Therefore, one final command is necessary:

  ```console
gmx editconf -f conf_gra5.pdb -o conf_gra5.gro -box 4.60725  4.76 1.6 
  ``` 
  
  An executable file with all the commands is also available: doit_confined.exe.
  
  The steepest descent method was used with a maximum number of iterations equal to 50000 to relax the initial multilayer graphene. The file used as a input in GROMACS was minim.mdp.
</p>

### Bulk fluids 

The mixtures of hydrocarbons and water were created with PACKMOL in a box of size 46.0725 × 47.6 × 53.2 Å. The files refered to this preparation are present in <a href="https://github.com/Flavianbraga/Codes-for-dissertation/tree/main/1_bulk">1_bulk</a>. Once in possession of the .pdb files, the following command is used, selectiong one hydrocarbon of interest at a time in the file bulk.inp:

  ```console
 packmol < bulk.inp
 ```
 It is important to remember that in Packmol, comments are adressed as "#" in bulk.inp. 
 
 Once again it necessary to convert .pdb files to .gro files using:
 
  ```console
gmx editconf -f conf_bulk.pdb -o conf_bulk.gro -box 4.60725 4.76 5.60
  ``` 
  


## Input files preparation

### Topology files

The files needed for the topology of the hydrocarbons were build as referece to another <a href="https://github.com/wesbarnett/OPLS-molecules">Github page</a>. 

  

 
